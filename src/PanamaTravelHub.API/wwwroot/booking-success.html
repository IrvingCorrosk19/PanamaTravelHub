<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reserva Confirmada — ToursPanama</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="/css/success.css" />
  <style>
  </style>
</head>
<body>
  <nav class="nav">
    <div class="nav-inner wrap">
      <div class="brand">
        <div class="mark"></div>
        <a href="/"><span class="brand-text">ToursPanama</span></a>
      </div>
      <div class="nav-links">
        <a href="/" class="nav-link">Tours</a>
        <a href="/reservas.html" class="nav-link">Mis Reservas</a>
      </div>
    </div>
  </nav>

  <div class="success-container">
    <div class="success-card">
      <div class="success-icon">✓</div>
      <h1 class="success-title">¡Reserva Confirmada!</h1>
      <p class="success-message">
        Tu reserva ha sido procesada exitosamente. Hemos enviado un correo de confirmación con todos los detalles.
      </p>

      <div class="booking-details">
        <div class="booking-detail-item">
          <span class="booking-detail-label">Número de Reserva</span>
          <span class="booking-detail-value" id="bookingId">-</span>
        </div>
        <div class="booking-detail-item">
          <span class="booking-detail-label">Monto Pagado</span>
          <span class="booking-detail-value" id="bookingAmount">-</span>
        </div>
        <div class="booking-detail-item">
          <span class="booking-detail-label">Estado</span>
          <span class="booking-detail-value" style="color: var(--accent);">Confirmada</span>
        </div>
      </div>

      <div class="success-actions">
        <a href="/reservas.html" class="btn-primary">Ver Mis Reservas</a>
        <a href="/" class="btn-secondary">Explorar Más Tours</a>
      </div>
    </div>
  </div>

  <script>
    // ✅ Función helper para formatear precios de forma segura
    function formatPrice(value, fallbackText = '$0.00') {
      const rawPrice = value ?? null;
      let price = Number(rawPrice ?? 0);
      
      // Validación: asegurar que price es un número válido y finito
      if (typeof price !== 'number' || isNaN(price) || !isFinite(price)) {
        console.warn('⚠️ [formatPrice] Precio inválido, usando 0:', { value, rawPrice, price });
        price = 0;
      }
      
      // Formatear precio
      const formattedPrice = price.toFixed(2);
      return price > 0 ? `$${formattedPrice}` : fallbackText;
    }

    // Obtener datos de la URL
    const urlParams = new URLSearchParams(window.location.search);
    const bookingId = urlParams.get('bookingId');
    const amount = urlParams.get('amount');

    if (bookingId) {
      document.getElementById('bookingId').textContent = bookingId;
    }
    if (amount) {
      // ✅ Usar función segura para formatear precio
      document.getElementById('bookingAmount').textContent = formatPrice(parseFloat(amount));
    }
  </script>
</body>
</html>
